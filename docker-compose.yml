version: "3.9"

services:
  ipvanish:
    build: .
    container_name: ipvanish-proxy

    cap_add:
      - NET_ADMIN

    devices:
      - /dev/net/tun:/dev/net/tun

    ports:
      - "8888:8888"

    environment:
      USERNAME: "YOUR_IPVANISH_USERNAME"
      PASSWORD: "YOUR_IPVANISH_PASSWORD"
      COUNTRY: "NL"
      RANDOMIZE: "true"

    restart: unless-stopped

    healthcheck:
      test: ["CMD", "/bin/sh", "/app/healthcheck.sh"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 20s

    sysctls:
      - net.ipv4.ip_forward=1

    security_opt:
      - no-new-privileges:true
